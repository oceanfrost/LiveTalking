# 预设音频功能文件清单

本次为LiveTalking项目添加了完整的预设音频功能说明和工具，以下是创建的所有文件：

## 📄 文档文件

### 1. **预设音频使用指南.md** ⭐⭐⭐
完整的预设音频使用指南，包含：
- 工作原理说明
- 详细配置步骤
- API使用方法
- 实际应用场景示例
- 性能优化建议
- 故障排查指南
- 进阶扩展功能

**适用对象：** 所有用户，尤其是需要深入了解功能的开发者

### 2. **PRESET_AUDIO_QUICKSTART.md** ⭐⭐⭐
快速开始文档，3步完成配置：
1. 生成预设音频
2. 准备图像序列
3. 启动服务并测试

包含常用技巧、故障排查和性能对比。

**适用对象：** 新手用户，快速上手

### 3. **README.md** (已更新)
在主README中添加了预设音频功能的说明和快速入口。

## 🛠️ 工具脚本

### 4. **generate_preset_audio.py** ⭐⭐⭐
预设音频批量生成工具，功能包括：
- 使用EdgeTTS批量生成音频
- 自动创建目录结构
- 生成custom_config.json配置文件
- 生成preset_mapping.json映射文件
- 支持自定义预设
- 列出可用语音选项

**使用方法：**
```bash
# 生成默认预设
python generate_preset_audio.py

# 生成自定义预设
python generate_preset_audio.py custom

# 查看可用语音
python generate_preset_audio.py list-voices
```

**默认生成的预设：**
- idle (1) - 静默/待机
- welcome (2) - 欢迎语
- greeting_morning (3) - 早上好
- greeting_afternoon (4) - 下午好
- greeting_evening (5) - 晚上好
- faq_hours (11) - 营业时间
- faq_location (12) - 地址位置
- faq_contact (13) - 联系方式
- faq_price (14) - 价格套餐
- faq_features (15) - 功能介绍
- goodbye (20) - 再见/结束
- transfer_human (21) - 转人工客服
- not_understand (22) - 未理解

### 5. **setup_preset_audio.bat**
Windows批处理脚本，一键完成所有配置：
- 检查Python环境
- 安装依赖（edge-tts）
- 运行生成脚本
- 创建占位符图像（可选）
- 显示下一步操作指引

**使用方法：**
```bash
# 双击运行或在命令行中执行
setup_preset_audio.bat
```

## 🌐 Web界面

### 6. **web/preset-audio-test.html** ⭐⭐⭐
预设音频功能测试页面，特性：
- 美观的UI界面
- 按功能分类的预设按钮
- 实时状态显示
- 操作日志记录
- 自定义配置面板
- 中断播放功能
- 服务器连接检测

**访问方式：**
启动LiveTalking服务后，浏览器访问：
```
http://localhost:8010/preset-audio-test.html
```

**功能区域：**
1. 欢迎语 & 问候语（4个按钮）
2. 常见问题回答（5个按钮）
3. 其他场景（4个按钮）
4. 控制面板（服务器设置、自定义播放、中断等）
5. 状态显示和日志

## 📊 配置文件示例

运行 `generate_preset_audio.py` 后会自动生成：

### data/custom_config.json
```json
[
   {
        "audiotype": 2,
        "imgpath": "data/custom_audio/welcome/image",
        "audiopath": "data/custom_audio/welcome/audio.wav"
   },
   ...
]
```

### data/preset_mapping.json
```json
{
    "welcome": 2,
    "欢迎": 2,
    "您好！欢迎使用我们的服务": 2,
    ...
}
```

## 📁 目录结构

运行工具后生成的目录结构：
```
data/
  custom_audio/
    idle/
      audio.wav
      image/
        (图像序列)
    welcome/
      audio.wav
      image/
        (图像序列)
    greeting_morning/
      audio.wav
      image/
        (图像序列)
    ... (其他预设)
  custom_config.json
  preset_mapping.json
```

## 🚀 快速使用流程

### 对于新用户：

1. **运行配置脚本**
   ```bash
   # Windows
   setup_preset_audio.bat
   
   # Linux/Mac
   python generate_preset_audio.py
   ```

2. **准备图像序列**（可选，测试时可跳过）
   - 将现有图像复制到各预设的image目录
   - 或使用占位符图像快速测试

3. **启动服务**
   ```bash
   python app.py --transport webrtc --model wav2lip --avatar_id wav2lip256_avatar1
   ```

4. **测试功能**
   - 浏览器打开：http://localhost:8010/preset-audio-test.html
   - 点击按钮测试

### 对于开发者：

1. **阅读完整指南**
   - [预设音频使用指南.md](预设音频使用指南.md)

2. **自定义预设**
   - 编辑 `generate_preset_audio.py` 中的预设列表
   - 或手动创建音频和配置

3. **集成到应用**
   - 使用 `/set_audiotype` API
   - 实现智能切换逻辑（预设 vs 实时TTS）

## 📋 核心API

### 播放预设音频
```
POST /set_audiotype
Body: {
    "sessionid": 0,
    "audiotype": 2,
    "reinit": true
}
```

### 中断播放
```
POST /interrupt_talk
Body: {
    "sessionid": 0
}
```

## 💡 应用场景

1. **客服系统**
   - 欢迎语（零延迟）
   - 常见问题快速回答
   - 转人工提示

2. **教育场景**
   - 课程欢迎语
   - 标准化讲解内容
   - 课间提示

3. **展览展示**
   - 参观欢迎
   - 展品介绍
   - 引导语音

4. **直播互动**
   - 开场白
   - 感谢语
   - 结束语

## ⚡ 性能优势

| 指标 | 预设音频 | 实时TTS |
|------|----------|---------|
| 响应延迟 | **0ms** | 1-3秒 |
| 稳定性 | **100%** | 依赖网络 |
| 并发能力 | **极高** | 受限 |
| 音质 | **最佳** | 良好 |
| 成本 | **一次性** | 按次计费 |

## 🎯 最佳实践

1. **混合使用**
   - 高频问题 → 预设音频
   - 个性化回复 → 实时TTS

2. **预设规划**
   - audiotype 1-10: 系统预留
   - audiotype 11-50: 常见问题
   - audiotype 51-100: 特殊场景
   - audiotype 100+: 自定义扩展

3. **图像同步**
   - 确保图像帧数匹配音频时长
   - 帧数 = 音频秒数 × 25

## 📞 技术支持

如有问题，请参考：
1. [预设音频使用指南.md](预设音频使用指南.md) - 故障排查章节
2. LiveTalking主文档: https://livetalking-doc.readthedocs.io/
3. GitHub Issues: https://github.com/lipku/LiveTalking/issues

## 🔄 更新日志

- 2025.01.17: 创建完整的预设音频功能文档和工具
  - 添加使用指南
  - 添加快速开始文档
  - 添加自动生成工具
  - 添加Web测试页面
  - 更新主README

---

**祝您使用愉快！享受零延迟的数字人体验！** 🎉
